---
Title: [Virtual Machine]Hyper-V使用记录
Date: 2020-03-31 22:53
Modified: 2020-03-31 22:53
Category: Virtual Machine
Tags: Virtual Machine, Hyper-V, Androidx86
Slug: Hyper-V sucks
Authors: mykonakona
Summary: 好难用，大概以后不会在用了……
---
这篇blog的起因是我购入了新机器（Lenove S740, i5 16G版本），装机过程中我为了偷懒，打算直接用Win10自带的Hyper-V，这样就省得装其他虚拟机软件了，也试试好不好用。

首先，因为需要一个Win环境的虚拟机去跑一些国产流氓软件（qq这种），所以我考虑新建一个LTSC版本的Win10虚拟机。这个地方Hyper-V给了一代和二代两种选择。我的建议是尽量选择新建gen2机器。因为gen2支持增强对话，对拷文件会比较方便，节省大量时间。如果建gen1机器的话，拷文件一种是通过设置局域网的共享文件夹，另一种好像是通过给虚拟机在硬盘上分一片虚拟硬盘的分区，总之两种方法都很麻烦。

然后开始碰上Hyper-V使用的第一个坑:一般情况下我们装系统到新建的虚拟机，都是通过虚拟的DVD光驱去读从网上下载得到的iso，只要在建虚拟机时勾选上使用镜像安装的选项并选好镜像，Hyper-V就会自动把DVD设备的启动顺序放在第一位（VMWare/VirtualBox也是这样）。但是实际安装时，Hyper-V是进不去安装界面的，而是显示一个提示：scsi dvd the boot loader failed的白屏页面。查了很多地方才知道这里需要在虚拟机开机的时候用最快的速度按enter键才能进入系统安装界面（你也可以在开机时多按几次enter）。说实话VMWare没有这个问题，都是直接就能进去了…

除了Win环境的虚拟机，我还有一个需求就是用通过安卓虚拟机看看青你（爱奇艺的网页端必须注册才能看它提供的所谓的“720p"，非常恶心）或者看口袋48直播。如果开了Hyper-V，那就没法用市面上类似雷电、蓝叠、mumu这类模拟器了，因为现在市面所有安卓模拟器都是VitrualBox架构的，会和Hyper-V冲突。这些软件一般也会被在自己的使用说明里提到要在Win下关闭Hyper-V才能正常使用。

那Hyper-V就没法用安卓模拟器了吗?也是有方法的，要想同时用可以参考https://developer.android.com/studio/run/emulator-acceleration#vm-windows-whpx 里“使用 Windows Hypervisor Platform 配置虚拟机加速”一节。

然后装android studio又会碰到一个小问题，就是dl.google.com被墙，这个可以改hosts https://blog.csdn.net/chen_z_p/article/details/102637956 （但还是很让人不爽）。另外android studio的这个模拟器是可以运行的，效果也不错，但很吃配置，我的S740运行一会CPU占用率一直是100%，这个方案也基本宣告失败。

另一种方案是说在hyper-v上装android-x86的，基本上android-x86.org上的镜像都试了个遍，装是能装上。但qq装完就一直弹停止停止。我google了下可能是由于android的x86镜像基本不带arm编译库的问题，导致微信、qq、口袋这些没法正常使用。

后来还试了下Win的docker desktop，流畅是很流畅，但感觉用的人还是偏少，有问题也还是linux下能查到的解决方案多。

说了这么多，我最后把Hyper-V关了，去装了一个VMWare。






